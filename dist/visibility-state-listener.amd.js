define(["event-emitter-object"],(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=t(e).default.create;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function t(e){var t=["webkit","ms","o","moz","khtml"].filter((function(t){return t+"Hidden"in e}));return t&&t.length>0?t[0]:""}var n=r(),i=e.window||("undefined"==typeof window?void 0:window),o=e.document||("undefined"==typeof document?void 0:document),u={error:null,started:!1,value:"visible",prefix:"",visibilityProp:"",hiddenProp:""};void 0!==i&&void 0!==o||(u.error="INVALID_GLOBALS"),u.error||(u.prefix=t(o),u.hiddenProp=u.prefix+(u.prefix.length>0?"H":"h")+"idden",u.visibilityProp=u.prefix+(u.prefix.length>0?"V":"v")+"isibilityState");var d=o?u.hiddenProp in o?"modern":o.addEventListener?"focus-blur":"focus-blur-ie":"";function a(){var e=o[u.visibilityProp];e!=u.value&&(u.value=e,n.emit("update",[e]))}function f(){var e="visible";e!=u.value&&(u.value=e,n.emit("update",[e]))}function v(){var e="hidden";e!=u.value&&(u.value=e,n.emit("update",[e]))}function s(){return!u.error&&(!0===u.started||("modern"==d?o.addEventListener(u.prefix+"visibilitychange",a,0):"focus-blur"==d?(i.addEventListener("focus",f,!0),i.addEventListener("blur",v,!0)):"focus-blur-ie"==d&&(o.attachEvent("onfocusin",f),o.attachEvent("onfocusout",v)),u.started=!0),!0)}function c(){return!u.error&&(!1===u.started||("modern"==d?o.removeEventListener(u.prefix+"visibilitychange",a,1):"focus-blur"==d?(i.removeEventListener("focus",f,!0),i.removeEventListener("blur",v,!0)):"focus-blur-ie"==d&&(o.detachEvent("onfocusin",f),o.detachEvent("onfocusout",v)),u.started=!1),!0)}return{on:n.on,start:s,pause:c,hasError:function(){return"string"==typeof u.error&&u.error.length>0},getError:function(){return u.error},getState:function(){return u.value}}}()}));
