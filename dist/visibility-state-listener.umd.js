!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("event-emitter-object")):"function"==typeof define&&define.amd?define(["event-emitter-object"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).VisibilityStateListener=t(e.EventEmitterObject)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=t(e).default.create;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};function t(e){var t=["webkit","ms","o","moz","khtml"].filter((function(t){return t+"Hidden"in e}));return t&&t.length>0?t[0]:""}var n=r(),i=e.window||("undefined"==typeof window?void 0:window),o=e.document||("undefined"==typeof document?void 0:document),u={error:null,started:!1,value:"visible",prefix:"",visibilityProp:"",hiddenProp:""};void 0!==i&&void 0!==o||(u.error="INVALID_GLOBALS"),u.error||(u.prefix=t(o),u.hiddenProp=u.prefix+(u.prefix.length>0?"H":"h")+"idden",u.visibilityProp=u.prefix+(u.prefix.length>0?"V":"v")+"isibilityState");var d=o?u.hiddenProp in o?"modern":o.addEventListener?"focus-blur":"focus-blur-ie":"";function f(){var e=o[u.visibilityProp];e!=u.value&&(u.value=e,n.emit("update",[e]))}function a(){var e="visible";e!=u.value&&(u.value=e,n.emit("update",[e]))}function s(){var e="hidden";e!=u.value&&(u.value=e,n.emit("update",[e]))}function v(){return!u.error&&(!0===u.started||("modern"==d?o.addEventListener(u.prefix+"visibilitychange",f,0):"focus-blur"==d?(i.addEventListener("focus",a,!0),i.addEventListener("blur",s,!0)):"focus-blur-ie"==d&&(o.attachEvent("onfocusin",a),o.attachEvent("onfocusout",s)),u.started=!0),!0)}function l(){return!u.error&&(!1===u.started||("modern"==d?o.removeEventListener(u.prefix+"visibilitychange",f,1):"focus-blur"==d?(i.removeEventListener("focus",a,!0),i.removeEventListener("blur",s,!0)):"focus-blur-ie"==d&&(o.detachEvent("onfocusin",a),o.detachEvent("onfocusout",s)),u.started=!1),!0)}return{on:n.on,start:v,pause:l,hasError:function(){return"string"==typeof u.error&&u.error.length>0},getError:function(){return u.error},getState:function(){return u.value}}}()}));
