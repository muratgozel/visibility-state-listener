const EventEmitter=require("event-emitter-object");function createVisibilityStateListener(a={}){function b(){const a=j[n];a!=h.value&&(h.value=a,g.emit("update"))}function c(){"visible"!=h.value&&(h.value="visible",g.emit("update"))}function d(){"hidden"!=h.value&&(h.value="hidden",g.emit("update"))}function e(){"undefined"==typeof i||"undefined"==typeof j||!0===h.started||("modern"==o?j.addEventListener(l+"visibilitychange",b,0):"focus-blur"==o?(i.addEventListener("focus",c,!0),i.addEventListener("blur",d,!0)):"focus-blur-ie"==o&&(j.attachEvent("onfocusin",c),j.attachEvent("onfocusout",d)),h.started=!0)}function f(){"undefined"==typeof i||"undefined"==typeof j||!1===h.started||("modern"==o?j.removeEventListener(l+"visibilitychange",b,1):"focus-blur"==o?(i.removeEventListener("focus",c,!0),i.removeEventListener("blur",d,!0)):"focus-blur-ie"==o&&(j.detachEvent("onfocusin",c),j.detachEvent("onfocusout",d)),h.started=!1)}const g=new EventEmitter({}),h={error:null,started:!1,value:"visible"},i=a.window||("undefined"==typeof window?void 0:window),j=a.document||("undefined"==typeof document?void 0:document);("undefined"==typeof i||"undefined"==typeof j)&&(h.error="INVALID_GLOBALS");let k=[];"undefined"!=typeof j&&(k=["webkit","ms","o","moz","khtml"].filter(a=>a+"Hidden"in j));const l=k&&0<k.length?k[0]:"",m=l+(0<l.length?"H":"h")+"idden",n=l+(0<l.length?"V":"v")+"isibilityState";let o=null;return"undefined"!=typeof j&&(o=m in j?"modern":j.addEventListener?"focus-blur":"focus-blur-ie"),{emitter:g,start:e,pause:f,getError:function(){return h.error},getState:function(){return h.value}}}module.exports=createVisibilityStateListener;